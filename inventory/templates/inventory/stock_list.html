{% extends "inventory/base.html" %}
{% load latam_numbers %}
{% block title %}Stock{% endblock %}
{% block content %}
<h1>Stock</h1>
<p class="subtitle">Listado de productos por depósito.</p>

<div class="card" style="margin-bottom:16px;">
    <div class="card-title">Transferir a MercadoLibre</div>
    {% if can_transfer %}
    <form method="post">
        {% csrf_token %}
        <div class="cards" style="grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));">
            <div>
                {{ transfer_form.product.label_tag }}
                {{ transfer_form.product }}
            </div>
            <div>
                {{ transfer_form.quantity.label_tag }}
                {{ transfer_form.quantity }}
            </div>
        </div>
        <div style="margin-top:12px;">
            <button type="submit">Transferir</button>
        </div>
    </form>
    {% else %}
    <div>Configurá los depósitos Común y MercadoLibre para habilitar transferencias.</div>
    {% endif %}
</div>

<div class="card table-card">
    <div class="card-title">Stock por depósito</div>
    <table>
        <thead>
            <tr>
                <th>SKU</th>
                <th>Producto</th>
                <th>Comun</th>
                <th>MercadoLibre</th>
                <th>Total</th>
            </tr>
        </thead>
        <tbody>
            {% for product in products %}
            <tr>
                <td>{{ product.sku }}</td>
                <td>{{ product.name }}</td>
                <td>{{ product.comun_qty|latam_number:2 }}</td>
                <td>{{ product.ml_qty|latam_number:2 }}</td>
                <td>{{ product.comun_qty|add:product.ml_qty|latam_number:2 }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="5">Aún no hay stock registrado.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
